[toc]

# 1.密码学基础

本文通过哈希算法学习密码学的两个重要概念，然后再简单介绍下RSA算法，这些都是后续学习区块链技术的基础。

# 哈希算法

有输入x ，函数H，以及输出H(X)。

+ x：可以是任何数据。
+ H函数：通过hash算法将输入x输出成hash值。
+ H(x)：哈希值，固定长度的一串英文+数字的字符，一般为256位或者更大。

# Collision resistance（抗碰撞性）

## hash碰撞

有数据x、y， 且x！=y，且H(x)  =  H(y)，这种情况称为hash碰撞，如果hash算法很简单，且输出空间很小，发生的概率就很大。

例如：

有5只不同颜色的球，有一百个人进行选择，那很容易产生有相同选择的人。

## 降低概率

如果有2^256种颜色的球给一百个人选，那产生相同选择的概率会很小。

2^256 = 115792089237316195423570985008687907853269984665640564039457584007913129639936

所以x！=y，且H(x)  =  H(y)的概率会很小，这就是密码学中的Collision resistance特性：

> 两个不同的数据通过哈希函数计算后，理论上不会生成同一个hash值。
>
> 例子：
>
> 有数据x、y， 且x！=y，则H(x)！=  H(y)

# Hiding（隐藏性）

输入x 经过函数H得到输出H(X)后，已经丢失了很多数据，输入数据的可能性是无限的（你并不知道输入的会是什么数据），目前除了穷举没有更好的办法，但是2^256太大了，比宇宙中所知的原子数量还大，而穷举出结果的概率很低，所以理论上H(x)倒推出x是可行的，实际操作就比较难了。

这一特性不仅仅是hash算法具备，非对称加密算法也具备。

# 两个特性的应用场景

## 完整性校验和防篡改

由于hash函数（如SHA-256）具备Collision resistance的特点，所以一旦输入发生了改变，输出就会不一样，利用这个特点可以对输入数据进行完整性和防篡改的校验。

例如：

1.下载文件：如何保证下载的文件和服务器的是同一个？对比两者的hash值即可。

## 公私钥

对称加密的弊端：必须要双方都知道私钥，传递私钥的方式是不一定安全的。

如果设计一对秘钥，公钥和私钥：

+ 公钥用来加密，私钥就用来解密。
+ 私钥加密，就用公钥进行解密。

### 只公开公钥

如果双方只公开公钥，就能保证私钥不被泄漏。

例如：

A公开自己的公钥a，B公开自己的公钥b。

1.A用公钥pb进行数据加密，B使用私钥privateB进解密。

2.B使用公钥pa进行回复数据的加密，A使用私钥privateA进行解密。

### 签名

你私钥加密的东西，所有具备你公钥的人都可以解密，这其实就提供了一个身份验证的机制。

例如：如何证明数据是A发送的？

1.A使用私钥对数据123进行加密。

2.只有使用你公钥的人才能解密出123，所以使用公钥的人知道这个公钥是A的，这就证明了数据是A发布的。



例如：如何证明手上的公钥是A的？（现阶段的验证机制，是中心化的，后续的笔记中会讲非中心化的证明方式）

1、A生成一个 私钥 / 公钥对。server.key/server.pub 

2、然后确认申请信息（域名、申请者信息、公钥），最后封装为一个.csr文件（文件内不包含私钥，私钥只在服务端存在）。

3、服务端将申请信息发送到CA，CA通过线上、线下多种手段验证申请者提供信息的真实性，如组织是否存在、企业是否合法、该组织是否拥有本域名的所有权等。

4、如果信息审核通过，将用 ca.key（CA私钥） 和请求文件加密生成 server.crt（服务器证书）  ，签发给申请者（服务端）。

   证书包含以下信息：申请者公钥、申请者组织信息、签发机构CA信息、有效时间、证书序列号等信息的明文，同时还会包含一个签名和签名产生的算法：首先使用散列函数计算公开的明文信息的信息摘要，然后采用CA的私钥对信息摘要进行加密，密文即为签名。所以服务器证书就是个用CA私钥签名的数字签名

5、客户端需要信任该网站的话，需要保存该服务的CA证书ca.crt（注意CA证书不是服务器证书，ca.crt与步骤四的ca.key是一对，ca.crt保存了CA的公钥）。

6、客户端向服务端发送请求时，服务端回返回服务器证书给客户端，客户端使用ca证书的公钥对数字签名进行解密，得到服务的信息摘要，再与从服务端返回的证书明文信息使用相同算法计算出来的信息摘要对比，如果一致则认证证书合法。

7、客户端还会验证证书相关的其他信息，如域名信息、有效时间等。

> ————————————————
> 版权声明：本文为CSDN博主「维梅」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。
> 原文链接：https://blog.csdn.net/liangweimei/article/details/111677290



### 如何保证私钥不被破解？

公私钥是一对，如果我生成很多对，然后用生成的公钥匹配你的公钥，如果匹配上那就知道了你的私钥。

在RSA算法中私钥公钥具备Hiding特性，如下公式：

~~~
　　	d是私钥，n是公钥
　　（1）ed≡1 (mod φ(n))。只有知道e和φ(n)，才能算出d。

　　（2）φ(n)=(p-1)(q-1)。只有知道p和q，才能算出φ(n)。

　　（3）n=pq。只有将n因数分解，才能算出p和q。
~~~

如果p是2^256中的一个，q也是2^256中的一个，他两的组合就是2^(2^256)，除了穷举别无他法。

# 结

目前我们就学习了

1.密码学中的两大特性：conlision resistance、Hiding。

2.Hash和RSA算法。

3.s防篡改和身份验证的机制。