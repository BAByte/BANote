[TOC]

# 正式开始学习源码

今天正式开始系统的学习安卓的源码，学习的书籍是 邓凡平《深入理解ANDROID 卷1》

# 安卓系统架构

这就要从安卓系统的架构开始说起了，安卓架构相信大家都看过一张图

![](https://img-my.csdn.net/uploads/201209/30/1348969664_7187.jpg) 

蓝色部分的开发语言是java,绿色和红色是c++/c，那绿色是什么东西？

绿色部分叫动态链接库 ，我们称作为native层，一般指的是c/c++写的函数，这些函数可以调用上层的java的代码。而java也可以调用这些c/c++ 写的函数。而红色部分就是linux内核驱动。

书上的例子十分准确，为了能记住我直接打一遍：

java程序是运行在JVM(虚拟机)中，这样就可以实现平台不相关性，java程序就能跑在不同的系统环境下。那JVM是属于哪层？就是native层，系统环境属于红色的部分，因为安卓其实就是linux，所以图中是linux，假设安卓底层是window，那红色部分就是window！我们知道，不同的系统环境对于文件或者其他设备的操作肯定是不一样的，所以需要JVM去适配，去兼容。

现在知道为什么安卓的结构是这样了吧！那你会疑问：为什么不直接用c++语言编写安卓的应用程序？那样安卓不就是一个llinux了吗？那没有那么多层的转换，不是运行效率会更加快吗？道理是这么个道理，那你问问自己：为什么你要学java不专攻c++？还有，你看linux做了这么多年，软件还是少的可怜，这种环境下，安卓当然选择拥抱java了！而且虽然一门编程语言兴起，但是不代表另一门语言会消失，早在java出生前，很多程序都是c++/c写的,所有想改朝换代不是那么的容易，所以安卓高搞这种架构也是一种折中的方案。

# 了解JNI

那就有一个问题啦，java是如何去调用c++/c的代码？？反过来呢？这里就要说到JNI了。JNI是一种技术，是方便java与c++之间相互调用对方代码的技术。（就是上图中蓝色的java和绿色的native部分怎么相互沟通的技术）。

看看下面：

~~~jva

java世界  <------ 使用JNI技术通信  --------->   native（c++）世界  ------> 对linux系统的操作。  
~~~



## 从MediaScanner下手

这个是安卓中用java写的MediaScanner类，他的作用就是扫描



































