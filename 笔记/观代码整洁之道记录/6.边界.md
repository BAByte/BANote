# 6.边界

书中主要是说到在使用第三方代码时的边界考虑，我觉得另一个需要考虑的边界是：当你接手现有代码，并进行更改时。

这一章的内容很少，但是其实非常重要，我注意到很程序员都会说有文档，看文档。但是我们实际开发中其实没有那么多的耐心去看完长篇大论的文档，假设文档还写的不咋地，也挺痛苦的。

所以我在写下新的功能、接手现有的代码或者接入第三方的库时，都会先从单元测试入手，这真的是上手一个新项目的好方法。在这里还是得感谢我的导师，他对我说过：如果你想用好一个库或一份代码，你必须要了解设计者的意图，最好的切入点就是开发者写的单元测试。十分受用。

# 8.2浏览和学习边界

作者的观点：

> 学习第三方程序包按照我们想要的方式进行工作，一旦整合进来，就不能保证第三方代码与我们的需求兼容。原作者不得不修改代码来满足他们自己的新需求。他们会修增缺陷，添加新功能。风险伴随着新版本来，当我们每次更新版本时，我们只需要从新运行我们的测试用例就知道是否兼容。

我们接入第三方代码时最烦的就是看文档，首先要看的是库的单元测试，作者一般会给出单元测试，或者会有sample。使用和学习第三方库的最好方式就是写几行代码，运行一下看看效果。

回想起我们第一次运行程序，看着控制台输出hellow world的那种兴奋。一名对技术热爱的程序员，对程序的运行结果充满了好奇，程序员就是喜欢这种：“快看，他运行起来了” 的快感，这是程序员前进的动力源泉。所以先动动手远比看先看枯燥的文档来的有意义。

# 8.5使用尚不存在的代码

作者说的情况其实很常见。在多人协作开发时，会遇到某一方的接口未定义，而书中的解决方案是定义个隔离的中间件。

如果两方的代码属于控制，不属于数据的交互，预先定义个隔离的API是很好的解决方案。但对于数据交互的接口：

+ 如果可以，先定义通信的数据结构
+ 否则就从需求出发，先考虑必要的数据结构，等到对方的api出来时，可以定义适配器去适配两端不同的数据类型。

但两种方案常常不是那么的理想，最终有可能还是要新加api，更改数据结构，但是确实能帮我们对未知的代码划定边界。

# 8.6整洁的边界

书中说到：

> 我们通过代码中少数引用带三方边界接口的位置来管理第三方边界。也可以对其进行包装，使得我们使用的东西都是受我们控制的。

我自己的理解有两个：

+ 对第三方库的使用尽量放在统一位置，避免第三方库的代码散落在项目的各处，可以界定出第三方代码和我们代码的边界。

+ 可以对第三方的库进行包装，使用我们熟悉且容易控制的代码。

第1点很常见，但是第二点很多时候是需要慎重考虑的。我很少使用第三方库，我常常拒绝使用第三方库，因为我不相信他们。就算一定要用，也是用谷歌推荐的。

事实上优秀的第三库的api使用过程是十分抽象的，从抽象的方式去使用api能使代码逻辑更清晰。但一些程序员会觉得使用繁琐，比如okhttp库，很多人对okhttp原有逻辑进行封装。

这个封装真的很考验功力，封装针对的是你的特定场景，但是假设你的未来的功能中出现了新的场景，你发现项目中有同事已经对okhttp库进行了封装，但是满足不了你这个场景，你改他的代码好呢？还是再封装一次好？这是不是就是书中说的：

> 不得不修改代码来满足他们自己的新需求。他们会修增缺陷，添加新功能。风险伴随着新版本来。

所以不要随便的就封装，要去理解设计者的意图，反而你封装了，后来接手你代码的人更加不敢用你的代码，因为他更相信第三方库的设计。





